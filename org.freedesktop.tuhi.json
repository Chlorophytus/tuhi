{
    "id": "org.freedesktop.tuhi",
    "command": "/app/bin/tuhi",
    "runtime": "org.freedesktop.Platform",
    "sdk": "org.freedesktop.Sdk",
    "runtime-version": "18.08",
    "cleanup": [ "/cache",
                 "/include",
                 "/lib/pkgconfig",
                 "/man",
                 "/share/aclocal",
                 "/share/devhelp",
                 "/share/gir-1.0",
                 "/share/gtk-doc",
                 "/share/man",
                 "/share/pkgconfig",
                 "/share/vala",
                 "/lib/systemd",
                 "*.la", "*.a" ],
    "build-options" : {
        "cflags": "-O2 -g",
        "cxxflags": "-O2 -g"
    },
    "finish-args": [
        "--system-talk-name=org.bluez",
        "--own-name=org.freedesktop.tuhi1"
    ],
    "modules": [
        {
            "name": "pygobject",
            "buildsystem": "simple",
            "build-commands": [
                "python3 setup.py install --prefix=/app"
            ],
            "build-options": {
                "env": {
                    "PYGOBJECT_WITHOUT_PYCAIRO" : "1"
                }
            },
            "sources": [
                {
                    "type": "archive",
                    "url": "https://ftp.gnome.org/pub/GNOME/sources/pygobject/3.32/pygobject-3.32.1.tar.xz",
                    "sha256": "32c99def94b8dea5ce9e4bc99576ef87591ea779b4db77cfdca7af81b76d04d8"
                }
            ]
        },
        {
            "name": "pyxdg",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "git",
                    "url": "git://anongit.freedesktop.org/xdg/pyxdg"
                }
            ],
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} ."
            ]
        },
        {
            "name": "python-pyparsing",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/pyparsing/pyparsing/releases/download/pyparsing_2.4.0/pyparsing-2.4.0.tar.gz",
                    "sha512": "71877dc006cce5c1b1d45e7cc89cd60e03cb80353387fb0c6498cfc0d69af465dc574d1bceb87248033e7a82694aa940e9fce1ca80b2ef538a8df51f697ef530"
                }
            ],
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} ."
            ]
        },
        {
            "name": "python-svgwrite",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "git",
                    "url": "https://github.com/mozman/svgwrite.git"
                }
            ],
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} ."
            ]
        },
        {
            "name": "tuhi",
            "buildsystem": "simple",
            "sources": [
                {
                    "type": "git",
                    "path": "."
                }
            ],
            "build-commands": [
                "pip3 install --no-index --find-links=\"file://${PWD}\" --prefix=${FLATPAK_DEST} ."
            ],
            "post-install": [
                "cp tools/kete.py /app/lib/python3.7/site-packages/kete.py",
                "cp tools/tuhi-kete-sandboxed.py /app/bin/tuhi-kete",
                "chmod +x /app/bin/tuhi-kete"
            ]
        }
    ]
}
